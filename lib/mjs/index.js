import{jsx as e,jsxs as t}from"react/jsx-runtime";import n,{useEffect as i,Children as r,isValidElement as a,cloneElement as o,useReducer as g,useRef as d}from"react";import{isFragment as s}from"react-is";function c(e,t){const n=getComputedStyle(t);if(!n)return;let i=e===p.Horizontal?t.clientWidth:t.clientHeight;return 0!==i?(e===p.Horizontal?i-=parseFloat(n.paddingLeft)+parseFloat(n.paddingRight):i-=parseFloat(n.paddingTop)+parseFloat(n.paddingBottom),i):void 0}function l(e,t,n=[]){i((()=>(window.addEventListener(e,t),()=>window.removeEventListener(e,t))),[e,t,...n])}!function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===n&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}("/* === Main Container === */\n.__dbk__container {\n  height: 100%;\n  width: 100%;\n\n  display: flex;\n  overflow: hidden;\n}\n\n.__dbk__container.Horizontal {\n  flex-direction: row;\n}\n\n.__dbk__container.Vertical {\n  flex-direction: column;\n}\n/* ====== */\n\n/* === Wrapper for each child element === */\n.__dbk__child-wrapper {\n  height: 100%;\n  width: 100%;\n}\n/* ====== */\n\n/* === Gutter === */\n.__dbk__gutter {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n/* .__dbk__gutter > div {\n  background: red;\n} */\n.__dbk__gutter.Horizontal {\n  height: 100%;\n  padding: 0 2px;\n  flex-direction: column;\n}\n.__dbk__gutter.Horizontal:hover {\n  cursor: col-resize;\n}\n\n.__dbk__gutter.Vertical {\n  width: 100%;\n  padding: 2px 0;\n  flex-direction: row;\n}\n.__dbk__gutter.Vertical:hover {\n  cursor: row-resize;\n}\n\n.__dbk__gutter.Light {\n  background: #EDF0EF;\n}\n.__dbk__gutter.Light:hover > .__dbk__dragger {\n  background: #76747B;\n}\n\n.__dbk__gutter.Dark {\n  background: #020203;\n}\n.__dbk__gutter.Dark:hover > .__dbk__dragger {\n  background: #9995A3;\n}\n/* ====== */\n\n/* === Gutter's Dragger === */\n.__dbk__dragger {\n  border-radius: 2px;\n}\n\n.__dbk__dragger.Horizontal {\n  width: 4px;\n  height: 24px;  \n}\n\n.__dbk__dragger.Vertical {\n  width: 24px;\n  height: 4px;  \n}\n\n.__dbk__dragger.Light {\n  background: #A6ACB5;\n}\n\n.__dbk__dragger.Dark {\n  background: #434252;\n}\n/* ====== */");const u=n.forwardRef((({className:t,theme:n,draggerClassName:i,direction:r=p.Vertical,onMouseDown:a},o)=>{const g=`__dbk__gutter ${r} ${t||n}`,d=`__dbk__dragger ${r} ${i||n}`;return e("div",Object.assign({className:g,ref:o,dir:r,onMouseDown:a},{children:e("div",{className:d},void 0)}),void 0)}));var h,p,_;function f(e,t,n){let i,r;return t?(i=e/2,r=e):n?(i=e,r=e/2):(i=e,r=e),{aGutterSize:i,bGutterSize:r}}function z(e,t){switch(t.type){case h.SetIsReadyToCompute:return Object.assign(Object.assign({},e),{isReady:t.payload.isReady});case h.CreatePairs:{const{direction:n,children:i,gutters:r}=t.payload,a=i[0].parentNode;if(!a)throw new Error("Cannot create pairs - parent is undefined.");const o=c(n,a);if(void 0===o)throw new Error(`Cannot create pairs - parent has undefined or zero size: ${o}.`);const g=[];return i.forEach(((e,t)=>{if(t>0){const e=i[t-1],o=i[t],d=r[t-1],s=n===p.Horizontal?e.getBoundingClientRect().left:e.getBoundingClientRect().top,c=n===p.Horizontal?o.getBoundingClientRect().right:o.getBoundingClientRect().bottom,l=n===p.Horizontal?e.getBoundingClientRect().width+d.getBoundingClientRect().width+o.getBoundingClientRect().width:e.getBoundingClientRect().height+d.getBoundingClientRect().height+o.getBoundingClientRect().height,u=n===p.Horizontal?d.getBoundingClientRect().width:d.getBoundingClientRect().height,h={idx:t-1,a:e,b:o,gutter:d,parent:a,start:s,end:c,size:l,gutterSize:u,aSizePct:100/i.length,bSizePct:100/i.length};g.push(h)}})),Object.assign(Object.assign({},e),{pairs:g})}case h.StartDragging:{const{gutterIdx:n}=t.payload;return Object.assign(Object.assign({},e),{isDragging:!0,draggingIdx:n})}case h.StopDragging:return Object.assign(Object.assign({},e),{isDragging:!1});case h.CalculateSizes:{const{direction:n,gutterIdx:i}=t.payload,r=e.pairs[i],a=c(n,r.parent);if(!a)throw new Error("Cannot calculate sizes - 'pair.parent' has undefined or zero size.");const o=r.gutter[n===p.Horizontal?"clientWidth":"clientHeight"],g=0===i,d=i===e.pairs.length-1,{aGutterSize:s,bGutterSize:l}=f(o,g,d);let u,h,_,z,b;return n===p.Horizontal?(u=r.a.getBoundingClientRect().left,h=r.b.getBoundingClientRect().right,z=(r.a.getBoundingClientRect().width+s)/a*100,b=(r.b.getBoundingClientRect().width+l)/a*100,_=r.a.getBoundingClientRect().width+s+l+r.b.getBoundingClientRect().width):(u=r.a.getBoundingClientRect().top,h=r.b.getBoundingClientRect().bottom,z=(r.a.getBoundingClientRect().height+s)/a*100,b=(r.b.getBoundingClientRect().height+l)/a*100,_=r.a.getBoundingClientRect().height+s+l+r.b.getBoundingClientRect().height),e.pairs[i]=Object.assign(Object.assign({},r),{start:u,end:h,size:_,aSizePct:z,bSizePct:b,gutterSize:o}),Object.assign({},e)}default:return e}}function b(e,t=0,n=[]){return r.toArray(e).reduce(((e,i,r)=>(s(i)?e.push.apply(e,b(i.props.children,t+1,n.concat(i.key||r))):a(i)?e.push(o(i,{key:n.concat(String(i.key)).join(".")})):"string"!=typeof i&&"number"!=typeof i||e.push(i),e)),[])}!function(e){e[e.SetIsReadyToCompute=0]="SetIsReadyToCompute",e[e.CreatePairs=1]="CreatePairs",e[e.CalculateSizes=2]="CalculateSizes",e[e.StartDragging=3]="StartDragging",e[e.StopDragging=4]="StopDragging"}(h||(h={})),function(e){e.Horizontal="Horizontal",e.Vertical="Vertical"}(p||(p={})),function(e){e.Light="Light",e.Dark="Dark"}(_||(_={}));const C=Number.MAX_VALUE;function w(e){return e===p.Horizontal?"col-resize":"row-resize"}const y={isReady:!1,isDragging:!1,pairs:[]};function S({direction:r=p.Horizontal,minWidths:a=[],minHeights:o=[],maxWidths:s=[],maxHeights:S=[],initialSizes:m,gutterTheme:x=_.Dark,gutterClassName:k,draggerClassName:R,children:v,onResizeStarted:I,onResizeFinished:B,classes:H=[]}){const D=b(v),[E,j]=g(z,y),N=d(null),O=d([]),$=d([]);O.current=[],$.current=[];const F=n.useCallback((e=>{j({type:h.SetIsReadyToCompute,payload:{isReady:e}})}),[]),G=n.useCallback(((e,t)=>{j({type:h.StartDragging,payload:{gutterIdx:t}});const n=E.pairs[t];null==I||I(n.idx),n.a.style.userSelect="none",n.b.style.userSelect="none",n.gutter.style.cursor=w(e),n.parent.style.cursor=w(e),document.body.style.cursor=w(e)}),[E.pairs]),P=n.useCallback((()=>{j({type:h.StopDragging});const e=[];for(let t=0;t<E.pairs.length;t++){const n=E.pairs[t],i=c(r,n.parent);if(void 0===i)throw new Error("Cannot call the 'onResizeFinished' callback - parentSize is undefined");if(void 0===n.gutterSize)throw new Error("Cannot call 'onResizeFinished' callback - gutterSize is undefined");const a=0===t,o=t===E.pairs.length-1,g=n.a.getBoundingClientRect()[r===p.Horizontal?"width":"height"],{aGutterSize:d,bGutterSize:s}=f(n.gutterSize,a,o),l=(g+d)/i*100;if(e.push(l),o){const t=(n.b.getBoundingClientRect()[r===p.Horizontal?"width":"height"]+s)/i*100;e.push(t)}}if(void 0===E.draggingIdx)throw new Error("Could not reset cursor and user-select because 'state.draggingIdx' is undefined");const t=E.pairs[E.draggingIdx];null==B||B(t.idx,e),t.a.style.userSelect="",t.b.style.userSelect="",t.gutter.style.cursor="",t.parent.style.cursor="",document.body.style.cursor=""}),[E.draggingIdx,E.pairs,r]),L=n.useCallback(((e,t)=>{j({type:h.CalculateSizes,payload:{direction:e,gutterIdx:t}})}),[]),T=n.useCallback(((e,t,n)=>{j({type:h.CreatePairs,payload:{direction:e,children:t,gutters:n}})}),[]),V=n.useCallback(((e,t,n,i)=>{const r=t[0].parentNode;if(!r)throw new Error("Cannot set initial sizes - parent is undefined");if(void 0===c(e,r))throw new Error("Cannot set initial sizes - parent has undefined size");t.forEach(((r,a)=>{const o=a===t.length-1;let g;if(t.length>1){n[o?a-1:a].getBoundingClientRect()[e===p.Horizontal?"width":"height"]}g=i&&a<i.length?`calc(${i[a]}% - 0px)`:`calc(${100/t.length}% - 0px)`,e===p.Horizontal?(r.style.width=g,r.style.height="100%"):(r.style.height=g,r.style.width="100%")}))}),[]),A=n.useCallback(((e,t)=>{if(void 0===E.draggingIdx)throw new Error("Cannot adjust size - 'draggingIdx' is undefined");const n=E.pairs[E.draggingIdx];if(void 0===n.size)throw new Error("Cannot adjust size - 'pair.size' is undefined");if(void 0===n.gutterSize)throw new Error("Cannot adjust size - 'pair.gutterSize' is undefined");const i=n.aSizePct+n.bSizePct,r=t/n.size*i,a=i-t/n.size*i,o=0===E.draggingIdx,g=E.draggingIdx===E.pairs.length-1,{aGutterSize:d,bGutterSize:s}=f(n.gutterSize,o,g),c=`calc(${r}% - ${d}px)`,l=`calc(${a}% - ${s}px)`;e===p.Horizontal?(n.a.style.width=c,n.b.style.width=l):(n.a.style.height=c,n.b.style.height=l)}),[E.draggingIdx,E.pairs,r]),W=n.useCallback(((e,t,n,i)=>{if(!E.isDragging)return;if(void 0===E.draggingIdx)throw new Error("Cannot drag - 'draggingIdx' is undefined");const r=E.pairs[E.draggingIdx];if(void 0===r.start)throw new Error("Cannot drag - 'pair.start' is undefined");if(void 0===r.size)throw new Error("Cannot drag - 'pair.size' is undefined");if(void 0===r.gutterSize)throw new Error("Cannot drag - 'pair.gutterSize' is undefined");let a=function(e,t){return e===p.Horizontal?t.clientX:t.clientY}(t,e)-r.start,o=16,g=16,d=C,s=C;n.length>E.draggingIdx&&(o=n[E.draggingIdx]),n.length>=E.draggingIdx+1&&(g=n[E.draggingIdx+1]),i.length>E.draggingIdx&&(d=i[E.draggingIdx]),i.length>=E.draggingIdx+1&&(s=i[E.draggingIdx+1]),a<r.gutterSize+o&&(a=r.gutterSize+o),a>=r.size-(r.gutterSize+g)&&(a=r.size-(r.gutterSize+g)),a>r.gutterSize+d&&(a=r.gutterSize+d),a<=r.size-(r.gutterSize+s)&&(a=r.size-(r.gutterSize+s)),A(t,a)}),[E.isDragging,E.draggingIdx,E.pairs,A]);function M(e,t){if(!e.current)throw new Error("Can't add element to ref object - ref isn't initialized");t&&!e.current.includes(t)&&e.current.push(t)}return l("mouseup",(()=>{if(E.isDragging){if(void 0===E.draggingIdx)throw new Error("Cannot calculate sizes after dragging = 'state.draggingIdx' is undefined");L(r,E.draggingIdx),P()}}),[E.isDragging,P]),l("mousemove",(e=>{E.isDragging&&W(e,r,r===p.Horizontal?a:o,r===p.Horizontal?s:S)}),[r,E.isDragging,W,a,o,s,S]),i((function(){if(!N.current)return;const e=N.current.parentElement;if(!e)return;const t=new ResizeObserver((()=>{const t=getComputedStyle(e),n=r===p.Horizontal?e.clientWidth:e.clientHeight;F(!!t&&!!n)}));return t.observe(e),()=>{t.disconnect()}}),[N.current,r]),i((function(){if(E.isReady){if(!O.current||!$.current)throw new Error("Cannot create pairs - either variable 'childRefs' or 'gutterRefs' is undefined");D.length<=1?V(r,O.current,$.current,m):(V(r,O.current,$.current,m),T(r,O.current,$.current))}}),[v,E.isReady,r,V,T,m]),e("div",Object.assign({className:`__dbk__container ${r}`,ref:N},{children:E.isReady&&D.map(((i,a)=>t(n.Fragment,{children:[e("div",Object.assign({ref:e=>M(O,e),className:"__dbk__child-wrapper "+(a<H.length?H[a]:"")},{children:i}),void 0),a<D.length-1&&e(u,{ref:e=>M($,e),className:k,theme:x,draggerClassName:R,direction:r,onMouseDown:e=>function(e,t){t.preventDefault(),L(r,e),G(r,e)}(a,e)},void 0)]},a)))}),void 0)}export{_ as GutterTheme,p as SplitDirection,S as default};
//# sourceMappingURL=index.js.map

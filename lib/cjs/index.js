"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react/jsx-runtime"),t=require("react"),n=require("react-is");function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=i(t);function a(e,t){const n=getComputedStyle(t);if(!n)return;let i=e===exports.SplitDirection.Horizontal?t.clientWidth:t.clientHeight;return 0!==i?(e===exports.SplitDirection.Horizontal?i-=parseFloat(n.paddingLeft)+parseFloat(n.paddingRight):i-=parseFloat(n.paddingTop)+parseFloat(n.paddingBottom),i):void 0}function o(e,n,i=[]){t.useEffect((()=>(window.addEventListener(e,n),()=>window.removeEventListener(e,n))),[e,n,...i])}!function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===n&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}("/* === Main Container === */\n.__dbk__container {\n  height: 100%;\n  width: 100%;\n\n  display: flex;\n  overflow: hidden;\n}\n\n.__dbk__container.Horizontal {\n  flex-direction: row;\n}\n\n.__dbk__container.Vertical {\n  flex-direction: column;\n}\n/* ====== */\n\n/* === Wrapper for each child element === */\n.__dbk__child-wrapper {\n  height: 100%;\n  width: 100%;\n}\n/* ====== */\n\n/* === Gutter === */\n.__dbk__gutter {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n/* .__dbk__gutter > div {\n  background: red;\n} */\n.__dbk__gutter.Horizontal {\n  height: 100%;\n  padding: 0 2px;\n  flex-direction: column;\n}\n.__dbk__gutter.Horizontal:hover {\n  cursor: col-resize;\n}\n\n.__dbk__gutter.Vertical {\n  width: 100%;\n  padding: 2px 0;\n  flex-direction: row;\n}\n.__dbk__gutter.Vertical:hover {\n  cursor: row-resize;\n}\n\n.__dbk__gutter.Light {\n  background: #EDF0EF;\n}\n.__dbk__gutter.Light:hover > .__dbk__dragger {\n  background: #76747B;\n}\n\n.__dbk__gutter.Dark {\n  background: #020203;\n}\n.__dbk__gutter.Dark:hover > .__dbk__dragger {\n  background: #9995A3;\n}\n/* ====== */\n\n/* === Gutter's Dragger === */\n.__dbk__dragger {\n  border-radius: 2px;\n}\n\n.__dbk__dragger.Horizontal {\n  width: 4px;\n  height: 24px;  \n}\n\n.__dbk__dragger.Vertical {\n  width: 24px;\n  height: 4px;  \n}\n\n.__dbk__dragger.Light {\n  background: #A6ACB5;\n}\n\n.__dbk__dragger.Dark {\n  background: #434252;\n}\n/* ====== */");const d=r.default.forwardRef((({className:t,theme:n,draggerClassName:i,direction:r=exports.SplitDirection.Vertical,onMouseDown:a},o)=>{const d=`__dbk__gutter ${r} ${t||n}`,s=`__dbk__dragger ${r} ${i||n}`;return e.jsx("div",Object.assign({className:d,ref:o,dir:r,onMouseDown:a},{children:e.jsx("div",{className:s},void 0)}),void 0)}));var s,g,c;function l(e,t,n){let i,r;return t?(i=e/2,r=e):n?(i=e,r=e/2):(i=e,r=e),{aGutterSize:i,bGutterSize:r}}function u(e,t){switch(t.type){case s.SetIsReadyToCompute:return Object.assign(Object.assign({},e),{isReady:t.payload.isReady});case s.CreatePairs:{const{direction:n,children:i,gutters:r}=t.payload,o=i[0].parentNode;if(!o)throw new Error("Cannot create pairs - parent is undefined.");const d=a(n,o);if(void 0===d)throw new Error(`Cannot create pairs - parent has undefined or zero size: ${d}.`);const s=[];return i.forEach(((e,t)=>{if(t>0){const e=i[t-1],a=i[t],d=r[t-1],g=n===exports.SplitDirection.Horizontal?e.getBoundingClientRect().left:e.getBoundingClientRect().top,c=n===exports.SplitDirection.Horizontal?a.getBoundingClientRect().right:a.getBoundingClientRect().bottom,l=n===exports.SplitDirection.Horizontal?e.getBoundingClientRect().width+d.getBoundingClientRect().width+a.getBoundingClientRect().width:e.getBoundingClientRect().height+d.getBoundingClientRect().height+a.getBoundingClientRect().height,u=n===exports.SplitDirection.Horizontal?d.getBoundingClientRect().width:d.getBoundingClientRect().height,p={idx:t-1,a:e,b:a,gutter:d,parent:o,start:g,end:c,size:l,gutterSize:u,aSizePct:100/i.length,bSizePct:100/i.length};s.push(p)}})),Object.assign(Object.assign({},e),{pairs:s})}case s.StartDragging:{const{gutterIdx:n}=t.payload;return Object.assign(Object.assign({},e),{isDragging:!0,draggingIdx:n})}case s.StopDragging:return Object.assign(Object.assign({},e),{isDragging:!1});case s.CalculateSizes:{const{direction:n,gutterIdx:i}=t.payload,r=e.pairs[i],o=a(n,r.parent);if(!o)throw new Error("Cannot calculate sizes - 'pair.parent' has undefined or zero size.");const d=r.gutter[n===exports.SplitDirection.Horizontal?"clientWidth":"clientHeight"],s=0===i,g=i===e.pairs.length-1,{aGutterSize:c,bGutterSize:u}=l(d,s,g);let p,h,f,_,z;return n===exports.SplitDirection.Horizontal?(p=r.a.getBoundingClientRect().left,h=r.b.getBoundingClientRect().right,_=(r.a.getBoundingClientRect().width+c)/o*100,z=(r.b.getBoundingClientRect().width+u)/o*100,f=r.a.getBoundingClientRect().width+c+u+r.b.getBoundingClientRect().width):(p=r.a.getBoundingClientRect().top,h=r.b.getBoundingClientRect().bottom,_=(r.a.getBoundingClientRect().height+c)/o*100,z=(r.b.getBoundingClientRect().height+u)/o*100,f=r.a.getBoundingClientRect().height+c+u+r.b.getBoundingClientRect().height),e.pairs[i]=Object.assign(Object.assign({},r),{start:p,end:h,size:f,aSizePct:_,bSizePct:z,gutterSize:d}),Object.assign({},e)}default:return e}}function p(e,i=0,r=[]){return t.Children.toArray(e).reduce(((e,a,o)=>(n.isFragment(a)?e.push.apply(e,p(a.props.children,i+1,r.concat(a.key||o))):t.isValidElement(a)?e.push(t.cloneElement(a,{key:r.concat(String(a.key)).join(".")})):"string"!=typeof a&&"number"!=typeof a||e.push(a),e)),[])}!function(e){e[e.SetIsReadyToCompute=0]="SetIsReadyToCompute",e[e.CreatePairs=1]="CreatePairs",e[e.CalculateSizes=2]="CalculateSizes",e[e.StartDragging=3]="StartDragging",e[e.StopDragging=4]="StopDragging"}(s||(s={})),exports.SplitDirection=void 0,(g=exports.SplitDirection||(exports.SplitDirection={})).Horizontal="Horizontal",g.Vertical="Vertical",exports.GutterTheme=void 0,(c=exports.GutterTheme||(exports.GutterTheme={})).Light="Light",c.Dark="Dark";const h=Number.MAX_VALUE;function f(e){return e===exports.SplitDirection.Horizontal?"col-resize":"row-resize"}const _={isReady:!1,isDragging:!1,pairs:[]};exports.default=function({direction:n=exports.SplitDirection.Horizontal,minWidths:i=[],minHeights:g=[],maxWidths:c=[],maxHeights:z=[],initialSizes:x,gutterTheme:b=exports.GutterTheme.Dark,gutterClassName:S,draggerClassName:C,children:w,onResizeStarted:y,onResizeFinished:m,classes:D=[]}){const k=p(w),[R,v]=t.useReducer(u,_),I=t.useRef(null),E=t.useRef([]),B=t.useRef([]);E.current=[],B.current=[];const H=r.default.useCallback((e=>{v({type:s.SetIsReadyToCompute,payload:{isReady:e}})}),[]),j=r.default.useCallback(((e,t)=>{v({type:s.StartDragging,payload:{gutterIdx:t}});const n=R.pairs[t];null==y||y(n.idx),n.a.style.userSelect="none",n.b.style.userSelect="none",n.gutter.style.cursor=f(e),n.parent.style.cursor=f(e),document.body.style.cursor=f(e)}),[R.pairs]),O=r.default.useCallback((()=>{v({type:s.StopDragging});const e=[];for(let t=0;t<R.pairs.length;t++){const i=R.pairs[t],r=a(n,i.parent);if(void 0===r)throw new Error("Cannot call the 'onResizeFinished' callback - parentSize is undefined");if(void 0===i.gutterSize)throw new Error("Cannot call 'onResizeFinished' callback - gutterSize is undefined");const o=0===t,d=t===R.pairs.length-1,s=i.a.getBoundingClientRect()[n===exports.SplitDirection.Horizontal?"width":"height"],{aGutterSize:g,bGutterSize:c}=l(i.gutterSize,o,d),u=(s+g)/r*100;if(e.push(u),d){const t=(i.b.getBoundingClientRect()[n===exports.SplitDirection.Horizontal?"width":"height"]+c)/r*100;e.push(t)}}if(void 0===R.draggingIdx)throw new Error("Could not reset cursor and user-select because 'state.draggingIdx' is undefined");const t=R.pairs[R.draggingIdx];null==m||m(t.idx,e),t.a.style.userSelect="",t.b.style.userSelect="",t.gutter.style.cursor="",t.parent.style.cursor="",document.body.style.cursor=""}),[R.draggingIdx,R.pairs,n]),N=r.default.useCallback(((e,t)=>{v({type:s.CalculateSizes,payload:{direction:e,gutterIdx:t}})}),[]),G=r.default.useCallback(((e,t,n)=>{v({type:s.CreatePairs,payload:{direction:e,children:t,gutters:n}})}),[]),T=r.default.useCallback(((e,t,n,i)=>{const r=t[0].parentNode;if(!r)throw new Error("Cannot set initial sizes - parent is undefined");if(void 0===a(e,r))throw new Error("Cannot set initial sizes - parent has undefined size");t.forEach(((r,a)=>{const o=a===t.length-1;let d;if(t.length>1){n[o?a-1:a].getBoundingClientRect()[e===exports.SplitDirection.Horizontal?"width":"height"]}d=i&&a<i.length?`calc(${i[a]}% - 0px)`:`calc(${100/t.length}% - 0px)`,e===exports.SplitDirection.Horizontal?(r.style.width=d,r.style.height="100%"):(r.style.height=d,r.style.width="100%")}))}),[]),$=r.default.useCallback(((e,t)=>{if(void 0===R.draggingIdx)throw new Error("Cannot adjust size - 'draggingIdx' is undefined");const n=R.pairs[R.draggingIdx];if(void 0===n.size)throw new Error("Cannot adjust size - 'pair.size' is undefined");if(void 0===n.gutterSize)throw new Error("Cannot adjust size - 'pair.gutterSize' is undefined");const i=n.aSizePct+n.bSizePct,r=t/n.size*i,a=i-t/n.size*i,o=0===R.draggingIdx,d=R.draggingIdx===R.pairs.length-1,{aGutterSize:s,bGutterSize:g}=l(n.gutterSize,o,d),c=`calc(${r}% - ${s}px)`,u=`calc(${a}% - ${g}px)`;e===exports.SplitDirection.Horizontal?(n.a.style.width=c,n.b.style.width=u):(n.a.style.height=c,n.b.style.height=u)}),[R.draggingIdx,R.pairs,n]),F=r.default.useCallback(((e,t,n,i)=>{if(!R.isDragging)return;if(void 0===R.draggingIdx)throw new Error("Cannot drag - 'draggingIdx' is undefined");const r=R.pairs[R.draggingIdx];if(void 0===r.start)throw new Error("Cannot drag - 'pair.start' is undefined");if(void 0===r.size)throw new Error("Cannot drag - 'pair.size' is undefined");if(void 0===r.gutterSize)throw new Error("Cannot drag - 'pair.gutterSize' is undefined");let a=function(e,t){return e===exports.SplitDirection.Horizontal?t.clientX:t.clientY}(t,e)-r.start,o=16,d=16,s=h,g=h;n.length>R.draggingIdx&&(o=n[R.draggingIdx]),n.length>=R.draggingIdx+1&&(d=n[R.draggingIdx+1]),i.length>R.draggingIdx&&(s=i[R.draggingIdx]),i.length>=R.draggingIdx+1&&(g=i[R.draggingIdx+1]),a<r.gutterSize+o&&(a=r.gutterSize+o),a>=r.size-(r.gutterSize+d)&&(a=r.size-(r.gutterSize+d)),a>r.gutterSize+s&&(a=r.gutterSize+s),a<=r.size-(r.gutterSize+g)&&(a=r.size-(r.gutterSize+g)),$(t,a)}),[R.isDragging,R.draggingIdx,R.pairs,$]);function P(e,t){if(!e.current)throw new Error("Can't add element to ref object - ref isn't initialized");t&&!e.current.includes(t)&&e.current.push(t)}return o("mouseup",(()=>{if(R.isDragging){if(void 0===R.draggingIdx)throw new Error("Cannot calculate sizes after dragging = 'state.draggingIdx' is undefined");N(n,R.draggingIdx),O()}}),[R.isDragging,O]),o("mousemove",(e=>{R.isDragging&&F(e,n,n===exports.SplitDirection.Horizontal?i:g,n===exports.SplitDirection.Horizontal?c:z)}),[n,R.isDragging,F,i,g,c,z]),t.useEffect((function(){if(!I.current)return;const e=I.current.parentElement;if(!e)return;const t=new ResizeObserver((()=>{const t=getComputedStyle(e),i=n===exports.SplitDirection.Horizontal?e.clientWidth:e.clientHeight;H(!!t&&!!i)}));return t.observe(e),()=>{t.disconnect()}}),[I.current,n]),t.useEffect((function(){if(R.isReady){if(!E.current||!B.current)throw new Error("Cannot create pairs - either variable 'childRefs' or 'gutterRefs' is undefined");k.length<=1?T(n,E.current,B.current,x):(T(n,E.current,B.current,x),G(n,E.current,B.current))}}),[w,R.isReady,n,T,G,x]),e.jsx("div",Object.assign({className:`__dbk__container ${n}`,ref:I},{children:R.isReady&&k.map(((t,i)=>e.jsxs(r.default.Fragment,{children:[e.jsx("div",Object.assign({ref:e=>P(E,e),className:"__dbk__child-wrapper "+(i<D.length?D[i]:"")},{children:t}),void 0),i<k.length-1&&e.jsx(d,{ref:e=>P(B,e),className:S,theme:b,draggerClassName:C,direction:n,onMouseDown:e=>function(e,t){t.preventDefault(),N(n,e),j(n,e)}(i,e)},void 0)]},i)))}),void 0)};
//# sourceMappingURL=index.js.map
